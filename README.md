
# Zone2OCR
Zone2OCR is a tool for document layout analysis. This tool aims at mapping a seg of zones generated by a segmentation algorithm (e.g., dhSegment) to the regions generated by OCR engine.


## Installation
1. Clone this repository
2. Install Anaconda or Miniconda ([installation procedure](https://docs.anaconda.com/anaconda/install/]))
3. Create a virtual environment and activate it
```
conda create -n <ENV_NAME>
conda activate <ENV_NAME>
```
4. Install Zone2OCR dependencies with
```
pip install .
```
(Optional) If one wants to run the dhSegment algorithm pretrained by [ImageNet]([http://www.image-net.org/](http://www.image-net.org/)) + [Europeana Historical Newspaper]([https://www.primaresearch.org/datasets/ENP](https://www.primaresearch.org/datasets/ENP)), install dhSegment dependencies with
```
pip install ./dhsegment/.
```
and install TensorFlow 1.13 with
```
conda  install  tensorflow-gpu=1.13.1
```
## Usage
1. Make sure to prepare a valid file structure as below: 
(Note: all segmentation result xml files should match with ocr xml files)
```
.root
├── zone_xmls     # segmentation results
│   ├── image1.xml  
│   ├── ...
│   └── image8.xml
├── ocr_xmls      # ocr results
│   ├── image1.xml  
│   ├── ...
│   └── image8.xml
└── images        # (optional) images for visual inspection
    ├── image1.jpg  
    ├── ...
    └── image8.jpg
```
(Optional) Pretrained dhSegment 
```
python run_segmentation.py -i <IMAGE_PATH> -s <SAVE_PATH> [-t <SMALL_REGION_THRESHOLD>]
```
* `-i`: The path to the folder containing image to be processed
* `-s`: The path to the folder to store output xml file
* `-t`: (Optional) A threshold for ignoring small zones [0,1] (default: 0.005)
2. Run mapping
```
python mapping.py
```
## Remark
Both segmentation result and OCR XML file have to follow [PAGE XML-schema](https://www.primaresearch.org/tools/PAGELibraries).
# OCR2Zone
Mapping OCR coordinates (zone-level) to its text content
